{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/launching-nextflow-pipelines-from-the-cloud","result":{"data":{"markdownRemark":{"id":"8e2f3f6d-2927-5585-a02d-7eab16957d72","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/066639ee22cfad45ce7a939174a34430/c3092/orchestra.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABTuLxBgJ//8QAGhABAQACAwAAAAAAAAAAAAAAAQIDEgARMf/aAAgBAQABBQLCDOGSLydNl781Fr3/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAdEAACAgEFAAAAAAAAAAAAAAAAAQIiIRESUXGB/9oACAEBAAY/ApcpFsdmu4ldpFpemD//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhMVGBkaH/2gAIAQEAAT8hEQVHsAXJ3VGdi5RaHpiY2nsMAUtzP//aAAwDAQACAAMAAAAQpP8A/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxAc7Lf/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQIBAT8QTTIL/8QAHRABAQACAwADAAAAAAAAAAAAAREAIUFRYTGxwf/aAAgBAQABPxBGAQG1iT6xIf8Anh1NOIsQqCR5cSYHBGlgr+YGJphMHG+HxySUBtVr2eZ//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/066639ee22cfad45ce7a939174a34430/8ac56/orchestra.webp 240w,\n/static/066639ee22cfad45ce7a939174a34430/d3be9/orchestra.webp 480w,\n/static/066639ee22cfad45ce7a939174a34430/e46b2/orchestra.webp 960w,\n/static/066639ee22cfad45ce7a939174a34430/f992d/orchestra.webp 1440w,\n/static/066639ee22cfad45ce7a939174a34430/882b9/orchestra.webp 1920w,\n/static/066639ee22cfad45ce7a939174a34430/569e6/orchestra.webp 4048w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/066639ee22cfad45ce7a939174a34430/09b79/orchestra.jpg 240w,\n/static/066639ee22cfad45ce7a939174a34430/7cc5e/orchestra.jpg 480w,\n/static/066639ee22cfad45ce7a939174a34430/6a068/orchestra.jpg 960w,\n/static/066639ee22cfad45ce7a939174a34430/644c5/orchestra.jpg 1440w,\n/static/066639ee22cfad45ce7a939174a34430/0f98f/orchestra.jpg 1920w,\n/static/066639ee22cfad45ce7a939174a34430/c3092/orchestra.jpg 4048w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/066639ee22cfad45ce7a939174a34430/6a068/orchestra.jpg\"\n            alt=\"Launching nextflow pipelines from the cloud\"\n            title=\"Launching nextflow pipelines from the cloud\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Slightly overdue post - have been busy running other things but here’s the promised guide on orchestrating a nextflow pipeline from a cloud server.</p>\n<h2 id=\"why-bother-setting-up-another-server-to-manage-your-nextflow-pipeline\" style=\"position:relative;\"><a href=\"#why-bother-setting-up-another-server-to-manage-your-nextflow-pipeline\" aria-label=\"why bother setting up another server to manage your nextflow pipeline permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why bother setting up another server to manage your Nextflow pipeline?</h2>\n<ol>\n<li><strong>Avoid premature termination of the pipeline</strong>. When you run a Nextflow pipeline from your local computer, your local computer is managing the tasks and communicating with Azure as jobs are completed. Depending on the complexity of your pipeline, this may be a long time (couple of days!). If your wi-fi router accidentally comes unplug or the connection is broken, the pipeline will terminate prematurely. While you could recover from this using <code class=\"language-text\">-resume</code>, you can avoid the risks of disconnection by using a cloud server, which is designed to run 24/7, to orchestrate this.</li>\n<li><strong>Location independence</strong>. You can start a pipeline from home (wfh being the consequence of covid) and perhaps go elsewhere and check in later.</li>\n<li><strong>Free up your local computer for other things</strong>. You do not have to keep your local computer running Nextflow constantly - just start the pipeline in the cloud and continue on with your usual day.</li>\n</ol>\n<h2 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h2>\n<ol>\n<li><a href=\"#1-obtaining-a-cloud-server\">Obtaining a cloud server</a></li>\n<li><a href=\"#2-logging-in-to-the-server\">Logging in to the server</a></li>\n<li><a href=\"#3-installation\">Installation</a></li>\n<li><a href=\"#4-check-nextflow-works\">Check Nextflow works</a></li>\n<li><a href=\"#5-clone-and-run-the-pipeline\">Clone and run the pipeline</a></li>\n<li><a href=\"#6-use-screen-to-launch-long-running-pipelines\">Use screen to launch long-running pipelines</a></li>\n</ol>\n<h2 id=\"1-obtaining-a-cloud-server\" style=\"position:relative;\"><a href=\"#1-obtaining-a-cloud-server\" aria-label=\"1 obtaining a cloud server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Obtaining a cloud server</h2>\n<p>Plenty of hosting providers provide you with access to a VPS (Virtual Private Server) running Ubuntu 20.04. My recommendation is DigitalOcean - fantastic documentation, much cheaper compared to AWS/Azure/GCP, good performance and reliability in my experience. The $5/month server is what I personally use and is more than capable of handling Nextflow.</p>\n<h3 id=\"setting-up-an-ubuntu-server-on-digitalocean\" style=\"position:relative;\"><a href=\"#setting-up-an-ubuntu-server-on-digitalocean\" aria-label=\"setting up an ubuntu server on digitalocean permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up an Ubuntu server on DigitalOcean</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/23dcf6640cbf936be06f1012a0ae12cc/8079d/do_droplet_creation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.91666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACtklEQVQ4y5VU2W7cMAz0/39X+xF9WKRA0718W4etw55ypOViESQBKoAQbUmjITliE0LANE3FlmXBMAyw1oLjOI5PTdc+G01KCU4AvHdwzhcwXvLd+OoiWrNtG/phhDG2sJznGfu+l0XOH+0zhq/MG7sBfycgpAMxbOAFZEjz3iPGiHVdy3/OCvoxBQrcEOg6H3gfBTADOednyDxMID3INQVkqvjNwf3cVxiGBLx1B35dD9DnAgvDwUPjOD5ByFhBnHNPEOadBX2ELAynA505QJ9h8SBBNGyCMHQeVGYE5Dp97tF0NHkH1ijMhN1+1JBpGqKGSSPYR78Ur+zJTCKagxsePzSc/xmsSRJSJEZCDenerle0bVvypSFpmMqEM8PiP13PWf6FjMFUc1tG48KO09ni7WIlh7losW27YryMurzf77jdbui6Dufzucz8Z4zB0Pfou7ZYjAENpbJIsYwYfTJRGWgeyUylVHVZNck17vPiP4uSUkTYvBjFuz5EXcXNTascIAhNBf/6rT7BJKOiQ/lpLd+xLbKgMRQafe/M45AwZ04lrCNXP75YBZSiRAnRC1iQeG+zSCjV6hkR6rRY/DjVlBDI2wW/7yt+nr5uGs0ad7z3GZdphxc9GlubBBcZ8p/LgCSaYL5aKYRbJSJJZ9/XonHwZT1fCkV9kebA10KfbYyV1QLM01B0SsBeKprkH3M1yqV8LRzcbxRwi4egz6UobBRObtWnx5k9Up9hfXpVn8yxapI+K1+rLPL2Qm0TgcpeYSPCTqmwUHFrb9Tk81vBtPNQLSWH07jDuIDFrjJvsD6U2fnaA4tRlw9tvpr2SbJ30lj4/JooRVlcwizGeZGMj4YaZCcRFimW22P83pgKttqG+hvHQRI7Ypotukn64WRxH1fxA25jKKxV7K8dPbywTqnq7R9bwLlCGxW9NwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/23dcf6640cbf936be06f1012a0ae12cc/8ac56/do_droplet_creation.webp 240w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/d3be9/do_droplet_creation.webp 480w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/e46b2/do_droplet_creation.webp 960w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/f992d/do_droplet_creation.webp 1440w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/882b9/do_droplet_creation.webp 1920w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/92e50/do_droplet_creation.webp 2100w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/23dcf6640cbf936be06f1012a0ae12cc/8ff5a/do_droplet_creation.png 240w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/e85cb/do_droplet_creation.png 480w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/d9199/do_droplet_creation.png 960w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/07a9c/do_droplet_creation.png 1440w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/29114/do_droplet_creation.png 1920w,\n/static/23dcf6640cbf936be06f1012a0ae12cc/8079d/do_droplet_creation.png 2100w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/23dcf6640cbf936be06f1012a0ae12cc/d9199/do_droplet_creation.png\"\n            alt=\"DigitalOcean VPS Setup\"\n            title=\"DigitalOcean VPS Setup\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"server-authentication\" style=\"position:relative;\"><a href=\"#server-authentication\" aria-label=\"server authentication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server authentication</h3>\n<p>For authentication, select SSH key to access your server from the terminal (mac/linux) or using PuTTY (windows):\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/56122dae6ab1d3b7e5780f14da02c262/8079d/do_droplet_ssh.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtElEQVQY05WQ3YoDIQyFff/37NXCVEfNv7GnHQrdq92Gj3DEnISkmMdRO7i3wRIe295o7MxcayHv35GvKLZ212xnIxZzV0O3uCrgh4mIamv4ukAB8nq1K5jFQ3gKDb6AVlIgpEs1RJzZiZ75LYI53csiktbo7PM8tVa73aJWP46YM81S9QnEJ5g8JyhLBI/9ZWQEjCWZz+E/fd8njpM4xd/AbLaYS4pIHaMSNcIK/wI79w7xAE4tmofUMHu1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/56122dae6ab1d3b7e5780f14da02c262/8ac56/do_droplet_ssh.webp 240w,\n/static/56122dae6ab1d3b7e5780f14da02c262/d3be9/do_droplet_ssh.webp 480w,\n/static/56122dae6ab1d3b7e5780f14da02c262/e46b2/do_droplet_ssh.webp 960w,\n/static/56122dae6ab1d3b7e5780f14da02c262/f992d/do_droplet_ssh.webp 1440w,\n/static/56122dae6ab1d3b7e5780f14da02c262/882b9/do_droplet_ssh.webp 1920w,\n/static/56122dae6ab1d3b7e5780f14da02c262/92e50/do_droplet_ssh.webp 2100w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/56122dae6ab1d3b7e5780f14da02c262/8ff5a/do_droplet_ssh.png 240w,\n/static/56122dae6ab1d3b7e5780f14da02c262/e85cb/do_droplet_ssh.png 480w,\n/static/56122dae6ab1d3b7e5780f14da02c262/d9199/do_droplet_ssh.png 960w,\n/static/56122dae6ab1d3b7e5780f14da02c262/07a9c/do_droplet_ssh.png 1440w,\n/static/56122dae6ab1d3b7e5780f14da02c262/29114/do_droplet_ssh.png 1920w,\n/static/56122dae6ab1d3b7e5780f14da02c262/8079d/do_droplet_ssh.png 2100w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/56122dae6ab1d3b7e5780f14da02c262/d9199/do_droplet_ssh.png\"\n            alt=\"DigitalOcean SSH Setup\"\n            title=\"DigitalOcean SSH Setup\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"2-logging-in-to-the-server\" style=\"position:relative;\"><a href=\"#2-logging-in-to-the-server\" aria-label=\"2 logging in to the server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Logging in to the server</h2>\n<p>Once your server is set up, log in to it.</p>\n<p>Mac/Linux:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ssh -i &lt;private_key.pem&gt; root@&lt;server_ip&gt;</code></pre></div>\n<p>For Windows I suggest using the PuTTy client. Depending on your choice of VPS and platform, you may wish to consult this guide: <a href=\"https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-20-04\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-20-04</a></p>\n<h2 id=\"3-installation\" style=\"position:relative;\"><a href=\"#3-installation\" aria-label=\"3 installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Installation</h2>\n<p>Install Java and screen first.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo apt update\nsudo apt install default-jre screen</code></pre></div>\n<p>We will install Nextflow in /nextflow. You can change this location if you wish.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">cd /nextflow\ncurl -s https://get.nextflow.io | bash</code></pre></div>\n<p>We then need to add this directory to PATH. Doing this allows you to type <code class=\"language-text\">nextflow</code> directly into the terminal. Open .bashrc file to begin.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">nano ~/.bashrc</code></pre></div>\n<p>Add the bottom, add the following line:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">export PATH=“/nextflow:$PATH”\n\n# this line is optional\nexport NXF_DEFAULT_DSL=1 \n# I am using DSL1 as per the docs when I was setting up my pipeline.\n# If you are using DSL1 you will need to add this to .bashrc.</code></pre></div>\n<p>Save and exit with <code class=\"language-text\">Ctrl+X</code> and <code class=\"language-text\">yes</code>. Next, we need to source the file.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">source ~/.bashrc</code></pre></div>\n<h2 id=\"4-check-nextflow-works\" style=\"position:relative;\"><a href=\"#4-check-nextflow-works\" aria-label=\"4 check nextflow works permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Check Nextflow works</h2>\n<p>If everything is installed correctly, typing <code class=\"language-text\">nextflow</code> into the terminal should show the program help screen.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">nextflow</code></pre></div>\n<h2 id=\"5-clone-and-run-the-pipeline\" style=\"position:relative;\"><a href=\"#5-clone-and-run-the-pipeline\" aria-label=\"5 clone and run the pipeline permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Clone and run the pipeline</h2>\n<p>Now it’s time to bring in your pipeline using the power of git.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">cd ~\ngit clone &lt;your_nextflow_pipeline_repository&gt;</code></pre></div>\n<p>For example, I would put in</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">git clone https://github.com/shaunchuah/cfdna_nextflow/</code></pre></div>\n<p>and this will bring in my pipeline at <code class=\"language-text\">~/cfdna_nextflow</code>.</p>\n<p>For my pipeline I would need to clone <code class=\"language-text\">sample_credentials.json</code> to <code class=\"language-text\">credentials.json</code> and fill it in with my Azure credentials.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">cd ~/cfdna_nextflow\ncp sample_credentials.json credentials.json\nnano credentials.json</code></pre></div>\n<p>Now you can launch the pipeline!</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">nextflow pipeline.nf -resume -profile test</code></pre></div>\n<p>Now your cloud server is orchestrating the cloud cluster! But let’s take this one step further…</p>\n<h2 id=\"6-use-screen-to-launch-long-running-pipelines\" style=\"position:relative;\"><a href=\"#6-use-screen-to-launch-long-running-pipelines\" aria-label=\"6 use screen to launch long running pipelines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Use screen to launch long-running pipelines</h2>\n<p>Reference: <a href=\"https://www.howtogeek.com/662422/how-to-use-linuxs-screen-command/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.howtogeek.com/662422/how-to-use-linuxs-screen-command/</a></p>\n<p>Here’s what I do when launching pipelines that may take days to weeks to complete. Create a screen session:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">screen</code></pre></div>\n<p>If this is the first time, there will be some text. Hit enter and it all disappears but you are now in a screen session. Try any command - eg. <code class=\"language-text\">nextflow</code>.</p>\n<p>To detach from the screen session, hit <code class=\"language-text\">Ctrl+A</code> and <code class=\"language-text\">D</code>.</p>\n<p>To list all screen sessions type <code class=\"language-text\">screen -ls</code>.</p>\n<p>To reattach to the screen session type <code class=\"language-text\">screen -r</code>.</p>\n<p>I launch my pipelines from within screen and hit <code class=\"language-text\">Ctrl+A</code> and <code class=\"language-text\">D</code> to detach. Now I can safely close my SSH connection to the server and the pipeline will remain running. Reconnect to the server and type <code class=\"language-text\">screen -r</code> and you will see that the pipeline remains running. This nifty trick will help avoid pipelines terminating because of flaky connections and give you true mobility to perform bioinformatics from anywhere with an internet connection.</p>\n<p>It also means that in 2022, you no longer need powerful desktop computers to run bioinformatics anymore. All you need is a credit card and you can access vast computing power way beyond any single machine is capable of.</p>\n<p>I hope you’ve found this series helpful. If this has helped you please let me know on Twitter!</p>\n<p><em>Bonus: If you want to take this even further, you could have a powerful cloud server to develop on using VSCode Remote Containers. Check out <a href=\"https://github.com/features/codespaces\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub Codespaces</a> as an example of this.</em></p>","fields":{"slug":"/posts/launching-nextflow-pipelines-from-the-cloud","tagSlugs":["/tag/bioinformatics/","/tag/azure/","/tag/nextflow/","/tag/cloud-computing/","/tag/dev-ops/"]},"frontmatter":{"date":"2022-04-28","description":"Let's orchestrate your cloud supercomputer.","tags":["Bioinformatics","Azure","Nextflow","Cloud computing","DevOps"],"title":"Launching Nextflow Pipelines from the Cloud","socialImage":{"publicURL":"/static/066639ee22cfad45ce7a939174a34430/orchestra.jpg"}}}},"pageContext":{"slug":"/posts/launching-nextflow-pipelines-from-the-cloud"}},"staticQueryHashes":["251939775","401334301","825871152"]}